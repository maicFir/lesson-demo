!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.infiniteScroll=t()}(this,function(){"use strict";var e="@@InfiniteScroll",t=function(e,t){var n,i,o,r,l,c=function(){e.apply(r,l),i=n};return function(){if(r=this,l=arguments,n=Date.now(),o&&(clearTimeout(o),o=null),i){var e=t-(n-i);e<0?c():o=setTimeout(function(){c()},e)}else c()}},n=function(e){return e===window?Math.max(window.pageYOffset||0,document.documentElement.scrollTop):e.scrollTop},i=document.defaultView.getComputedStyle,o=function(e){for(var t=e;t&&"HTML"!==t.tagName&&"BODY"!==t.tagName&&1===t.nodeType;){var n=i(t).overflowY;if("scroll"===n||"auto"===n)return t;t=t.parentNode}return window},r=function(e){return e===window?document.documentElement.clientHeight:e.clientHeight},l=function(e){return e===window?n(window):e.getBoundingClientRect().top+n(window)},c=function(e){for(var t=e.parentNode;t;){if("HTML"===t.tagName)return!0;if(11===t.nodeType)return!1;t=t.parentNode}return!1},s=function(){if(!this.binded){this.binded=!0;var e=this,n=e.el,i=n.getAttribute("infinite-scroll-throttle-delay"),r=200;i&&(r=Number(e.vm[i]||i),(isNaN(r)||r<0)&&(r=200)),e.throttleDelay=r,e.scrollEventTarget=o(n),e.scrollListener=t(u.bind(e),e.throttleDelay),e.scrollEventTarget.addEventListener("scroll",e.scrollListener),this.vm.$on("hook:beforeDestroy",function(){e.scrollEventTarget.removeEventListener("scroll",e.scrollListener)});var l=n.getAttribute("infinite-scroll-disabled"),c=!1;l&&(this.vm.$watch(l,function(t){e.disabled=t,!t&&e.immediateCheck&&u.call(e)}),c=Boolean(e.vm[l])),e.disabled=c;var s=n.getAttribute("infinite-scroll-distance"),a=0;s&&(a=Number(e.vm[s]||s),isNaN(a)&&(a=0)),e.distance=a;var d=n.getAttribute("infinite-scroll-immediate-check"),f=!0;d&&(f=Boolean(e.vm[d])),e.immediateCheck=f,f&&u.call(e);var m=n.getAttribute("infinite-scroll-listen-for-event");m&&e.vm.$on(m,function(){u.call(e)})}},u=function(e){var t=this.scrollEventTarget,i=this.el,o=this.distance;if(!0===e||!this.disabled){var c=n(t),s=c+r(t);(t===i?t.scrollHeight-s<=o:s+o>=l(i)-l(t)+i.offsetHeight+c)&&this.expression&&this.expression()}},a={bind:function(t,n,i){t[e]={el:t,vm:i.context,expression:n.value};var o=arguments;t[e].vm.$on("hook:mounted",function(){t[e].vm.$nextTick(function(){c(t)&&s.call(t[e],o),t[e].bindTryCount=0;!function n(){t[e].bindTryCount>10||(t[e].bindTryCount++,c(t)?s.call(t[e],o):setTimeout(n,50))}()})})},unbind:function(t){t&&t[e]&&t[e].scrollEventTarget&&t[e].scrollEventTarget.removeEventListener("scroll",t[e].scrollListener)}},d=function(e){e.directive("InfiniteScroll",a)};return window.Vue&&(window.infiniteScroll=a,Vue.use(d)),a.install=d,a});